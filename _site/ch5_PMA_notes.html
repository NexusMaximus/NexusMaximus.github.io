<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
        <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>PMA Ch.5 notes: IDA Pro | KyleTheReverser</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="PMA Ch.5 notes: IDA Pro" />
<meta name="author" content="Kyle" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="There is a HUGE amount of content to know about IDA, and these notes hardly puts a dent in covering the helpful content." />
<meta property="og:description" content="There is a HUGE amount of content to know about IDA, and these notes hardly puts a dent in covering the helpful content." />
<link rel="canonical" href="http://localhost:4000/ch5_PMA_notes" />
<meta property="og:url" content="http://localhost:4000/ch5_PMA_notes" />
<meta property="og:site_name" content="KyleTheReverser" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-09-04T18:32:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@" />
<meta name="twitter:creator" content="@Kyle" />
<script type="application/ld+json">
{"description":"There is a HUGE amount of content to know about IDA, and these notes hardly puts a dent in covering the helpful content.","author":{"@type":"Person","name":"Kyle"},"@type":"BlogPosting","url":"http://localhost:4000/ch5_PMA_notes","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/images/logo.png"},"name":"Kyle"},"headline":"PMA Ch.5 notes: IDA Pro","dateModified":"2018-09-04T18:32:00-06:00","datePublished":"2018-09-04T18:32:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/ch5_PMA_notes"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    

    <!-- Site Favicon -->
    <link rel="shortcut icon" href="http://localhost:4000/assets/images/favicon.ico" type="image/png" />

    <!-- Font Embed Code -->
    <link href="https://fonts.googleapis.com/css?family=Karla:400,400i,700,700i" rel="stylesheet" />

    <!-- CSS Styles -->
    <link href="/assets/css/style.css" rel="stylesheet">

</head>



<body class="layout-post">
    <div id="page" class="site">

        
        <header id="masthead" class="site-header outer">
    <div class="site-header-inside">
        <div class="site-branding">
            
                <p class="site-logo"><a href="/" rel="home"><img src="/assets/images/logo.png" alt="KyleTheReverser" /></a></p>
                <h1 class="site-title screen-reader-text"><a href="" rel="home"></a></h1>
            
        </div><!-- .site-branding -->
        <nav id="main-navigation" class="site-navigation" aria-label="Primary Navigation">
            <ul class="menu">
            
                <li class="menu-item"><a href="/about">About</a></li>
            
            </ul>
            <button id="sidebar-show" class="sidebar-toggle"><span class="screen-reader-text">Open Sidebar</span><span class="icon-more" aria-hidden="true"></span></button>
        </nav><!-- .site-navigation -->
    </div><!-- .site-header-inside -->
</header><!-- .site-header -->
        

        <div id="content" class="site-content fadeInDown delay_075s">
    <main id="main" class="site-main outer">
        <article class="post-full inner">
            <header class="post-header">
                <div class="post-meta">
                    <time class="post-date" datetime="2018-09-04">September 4,
                        2018</time>
                </div><!-- .post-meta -->
                <h1 class="posttitle">PMA Ch.5 notes: IDA Pro</h1>
            </header><!-- .post-header -->
            
            <div class="post-content">
                <p>There is a HUGE amount of content to know about IDA, and these notes hardly puts a dent in covering the helpful content.</p>

<h2 id="chapter-summary-questions">Chapter summary questions</h2>
<ol>
  <li>
    <p>In two sentences or less, provide an overview of what this chapter is about.</p>

    <p>This chapter introduces Ida Pro, which is one of the most important tools in the market.</p>
  </li>
  <li>
    <p>What are the three most important takeaways from this chapter?</p>

    <p>Ida is an extremely powerful tool, and the information in the chapter is just barely enough to <em>get started</em>. More will be provided as the book continues.</p>
  </li>
  <li>
    <p>What problems does this chapter address? In other words, why should we care about this chapter?</p>

    <p>This chapter is more of a flyover tutorial than a conceptually dense section of the book. As such, we should care because it provides tips and tricks to get a novice reverser up and running with Ida.</p>
  </li>
</ol>

<h2 id="terminology">Terminology</h2>
<p><strong>Rebasing</strong>: PE assets/images/posts are compiled to load at a preferred base address. If the Windows loader cannot use this address (say, because it’s taken up by another program), then <em>rebasing</em> may occur. It’s not explicitly defined in this chapter, but they do mention that if DLLs appear to be loading into processes different than what Ida says, the DLL may be being rebased, and this can be fixed by clicking the <em>Manual Load</em> checkbox on the load file window.</p>

<h2 id="ida-cheatsheet">Ida Cheatsheet</h2>
<ul>
  <li>
    <p>switch between graph mode and text mode: <strong>space</strong></p>
  </li>
  <li>
    <p>Cross references are things that help you find where certain names are used. Think of it as the opposite of clicking a link– it goes the other direction. Find cross references with <strong>x</strong>.</p>
  </li>
  <li>Jumping to a virtual address can be done with <strong>g</strong>. GOTO, of course!
    <ul>
      <li>Jumping to a raw offset is possible too with <strong>jump -&gt; jump to file offset</strong>.</li>
    </ul>
  </li>
  <li>Has Ida failed to identify some code as a function? Create it by pressing <strong>p</strong>.
    <ul>
      <li>Has Ida also failed to identify a EBP-based stack frame, and thus not abstracted away some simple changes that add for readability (like putting variable names into assembly instruction operand spots)? Try <strong>Alt+p</strong>, select <strong>BP based frame</strong>, and specify <strong>4 bytes for saved registers.</strong></li>
    </ul>
  </li>
  <li>
    <p>Add your own comments to places by putting the cursor on a line of a disassembly and hitting <strong>:</strong>. OR BETTER YET: put a comment on an address that has cross-references to it, and have the comment be repeated: hit <strong>;</strong>.</p>
  </li>
  <li>
    <p>Sometimes Ida mislabels numbers to be addresses, or vice versa, since everything’s a number under the hood anyway. Change numbers to cross-referencable addresses and back via <strong>O</strong>.</p>
  </li>
  <li>
    <p>To represent highlighted bytes as code: <strong>C</strong></p>
  </li>
  <li>To represent defined code as not a function, code, or data: <strong>U</strong></li>
</ul>

<h2 id="ida-tips-and-tricks">Ida Tips and Tricks</h2>

<ul>
  <li>When Idaing, you may find a few keystrokes suddenly causes the interface to become impossible to navigate (imagine the first couple times you used Vim). Reset the interface with <strong>Windows -&gt; reset desktop.</strong>
    <ul>
      <li>Similarly, if you love your current desktop configuration, do a <strong>Windows -&gt; save desktop</strong>.</li>
    </ul>
  </li>
  <li>Graph mode excludes certain helpful info, such as line numbers and op codes. Change this:
    <ul>
      <li><strong>Options -&gt; general -&gt; select <code class="highlighter-rouge">line prefixes</code></strong> and set number of opcode bytes to 6. Most instructions are 6 or less bytes, so setting this to 6 will allow one to see the memory locations and opcode values for each instruction in the code listing.</li>
    </ul>
  </li>
  <li>
    <p><strong>Auto Comments</strong> can help aid analysis via adding assembly comments throughout the disassembly window. Go to <strong>Options -&gt; General</strong> and click the <strong>Auto Comments</strong> checkbox.</p>
  </li>
  <li>For information on plugins for Ida, see page 103. I’m not good enough to appreciate that yet, so I’m putting this subsection on the backburner for now.</li>
</ul>

<h3 id="useful-analysis-windows">Useful Analysis Windows</h3>
<ul>
  <li><em>Functions Window</em>: lists all functions in the executable and each function’s length.</li>
  <li><em>Names window</em>: Lists every address with a name, including functions, named code, named data, and strings.</li>
  <li><em>Strings window</em>: Shows all strings. Default is ASCII only; longer than 5 characters.
    <ul>
      <li>Can change this by right-clicking in the strings window and selecting setup.</li>
    </ul>
  </li>
  <li><em>Imports/Exports windows</em>: self-explanatory. The exports window is helpful when analyzing DLLs (since DLLs provide exports).</li>
  <li>
    <p><em>Structures window</em>: Lists the layout of all active data structures.</p>
  </li>
  <li>In general, double clicking stuff in windows will link back to the disassembly window.</li>
</ul>

<h3 id="searching">Searching</h3>
<p>The Search functionality in the disassembly window is helpful. See p.94 for more details about common searches (if they aren’t self explanatory in Ida). (Search -&gt; next code, search -&gt; test, search-&gt; sequence of bytes for starters)</p>

<h3 id="graphing-options">Graphing Options</h3>
<p>Graphing options help provide insight into the control flow of the program. However, due to how they are used, it  wouldn’t be very helpful for me to annotate this section as it’s so diagram dependent. Look at page 98 for graphing options information.</p>

<h3 id="enhancing-the-disassembly">Enhancing the disassembly</h3>

<h4 id="renaming-locations">Renaming Locations</h4>
<p>Should be doable by right clicking names of things like sub_400699. Changes propogate throughout the program.</p>

<h4 id="comments">Comments</h4>
<p>Add your own comments to places by putting the cursor on a line of a disassembly and hitting <strong>:</strong>. OR BETTER YET: put a comment on an address that has cross-references to it, and have the comment be repeated: hit <strong>;</strong>.</p>

<h4 id="formatting-operands">Formatting operands</h4>
<p>You can right click constants and represent the data there in a plethora of ways (binary, octal, hex, decimal).</p>

<p>Imagine <code class="highlighter-rouge">stdin.</code> What number comes straight to mind? 0, of course! <code class="highlighter-rouge">stdin</code> is a named constant of sorts. Ida can help reverse where a compiler plugged in a number for a named constant in the initial source code. The option to do so is given in the same menu as the above options.</p>

<p>If the constants don’t show up, then the proper libraries that correspond to those function calls may not be loaded in Ida. Do a <strong>View -&gt; open subviews -&gt; type libraries</strong> to get to the submenu to change that.</p>

<h4 id="loading-symbolic-constants">Loading symbolic constants</h4>
<p>If you have random looking numbers being passed to Windows API functions, you can have Ida identify what constants those numbers refer to. Go to <strong>View -&gt; Open Subviews -&gt; Type Libraries</strong> and then right click and load a new library. Look for <code class="highlighter-rouge">ntapi</code> and load it. (I presume this will work assuming <code class="highlighter-rouge">ntapi</code> shows up, which, in my case, it does <em>not</em>.)</p>

<h2 id="page-to-page-notes">Page-to-page notes</h2>

<ul>
  <li>
    <p>When loading a program, Ida maps the file into memory in a similar fashion to how the OS does it.</p>
  </li>
  <li>
    <p>When loading a file into Ida, you can choose to interpret the file as raw data. This can be helpful in the case that malware has additional stuff appended to the end of the executable. This extra stuff would normally not be loaded into memory.</p>
  </li>
  <li>Jump arrow color key:
    <ul>
      <li><em>red</em>: Jump not taken</li>
      <li><em>green</em>: Jump taken</li>
      <li><em>blue</em>: unconditional jump</li>
    </ul>
  </li>
  <li>Ida provides a <em>Navigation band.</em>
    <ul>
      <li>Light blue is library code recognized by Ida’s super cool ‘FLIRT’ technology.</li>
      <li>Red is compiler generated code.</li>
      <li>Dark blue is user-written code.</li>
    </ul>
  </li>
</ul>


            </div>
            <footer class="post-footer">
                
                <div class="post-share">
                    <span class="post-share-title">Share:</span>
                    <a target="_blank" href="https://twitter.com/share?text=PMA+Ch.5+notes%3A+IDA+Pro&amp;url=https://nexusmaximus.github.ioch5_PMA_notes">Twitter</a>
                    <a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://nexusmaximus.github.ioch5_PMA_notes">Facebook</a>
                </div><!-- .share-post -->
            </footer>
            <div class="author-box">
                <div class="author-avatar"><img src="/assets/images/authorimage.jpg" alt="Kyle's Picture"
                        class="avatar"></div>
                <div class="author-details">
                    <h2 class="author-title">About Kyle</h2>
                    <p class="author-description">bio here</p>
                </div>
            </div>
            

        </article>
        
        <section class="read-next inner">
            <h2 class="read-next-title">Read Next</h2>
            
            <article class="post">
                <header class="post-header">
                    <div class="post-meta">
                        <time class="published" datetime="September 3, 2018">September 3, 2018</time>
                    </div>
                    <h3 class="post-title"><a href="/ch4_PMA_notes">PMA Ch. 4 notes: A Crash Course in x86 Disassembly</a></h3>
                    <p class="post-tags">
                        
                    </p>
                </header>
                
                
            </article>
            
            
            <article class="post">
                <header class="post-header">
                    <div class="post-meta">
                        <time class="published" datetime="September 5, 2018">September 5, 2018</time>
                    </div>
                    <h3 class="post-title"><a href="/PMA_Ch5_Labs">PMA Ch.5 Lab: Ida Pro Practice</a></h3>
                    <p class="post-tags">
                        
                    </p>
                </header>
                
                
            </article>
            
        </section><!-- .read-next -->
    </main><!-- .site-main -->
</div><!-- .site-content -->

        

        

        <footer id="colophon" class="site-footer outer">
            <div class="site-footer-inside">
                <p class="social-links">
    
    <a href="https://twitter.com/KyleTheReverser" target="_blank">
        <span class="fa-twitter fa" aria-hidden="true"></span>
        <span class="screen-reader-text">Twitter</span>
    </a>
    
    
    
    <a href="https://github.com/NexusMaximus" target="_blank">
        <span class="fa-github fa" aria-hidden="true"></span>
        <span class="screen-reader-text">GitHub</span>
    </a>
    
    
    
    
    
    
    
    
</p>
                <p class="site-info">
                    <a href="#">KyleTheReverser</a> &copy; 2019 . Horace theme by
                    <a target="_blank" href="https://justgoodthemes.com/">JustGoodThemes</a>. <br />
                    Powered by <a target="_blank" href="https://jekyllrb.com/">Jekyll</a>.
                </p>
                <p class="back-to-top">
                    <a id="top-button" class="top-button" href="#page">
                        <span class="icon-arrow-up" aria-hidden="true"></span>
                        <span class="screen-reader-text">Back to top</span>
                    </a>
                </p>
            </div><!-- .site-footer-inside -->
        </footer><!-- .site-footer -->
    </div><!-- .site -->
    <div id="site-overlay" class="site-overlay"></div>
    <aside id="sidebar" class="sidebar">
	<div class="sidebar-scrollable">
		<div class="sidebar-inside">
			<button id="sidebar-hide" class="sidebar-toggle"><span class="screen-reader-text">Close Sidebar</span><span
				    aria-hidden="true" class="icon-close"></span></button>
			<nav id="sidebar-navigation" class="widget site-navigation">
				<h2 class="widget-title">Explore Site</h2>
				<ul class="menu">
					
						<li class="menu-item"><a href="/about">About</a></li>
					
				</ul>
			</nav>
			
<section class="widget widget-text">
    <h2 class="widget-title">About KyleTheReverser</h2>
    <p>This is an organized hub for everything technical that I write, set up, or figure out over the course of my last year as a Masters student.</p>
</section>


<section class="widget widget-recent-posts">
    <h2 class="widget-title">Recent Articles</h2>
    <ul>
        
        <li>
            <div class="post-header">
                <div class="post-meta">
                    <time class="published" datetime="??">March 2, 2019</time>
                </div>
                <div class="post-title">
                    <a href="http://localhost:4000/PE_FF_Exploration">Exploring How Packers Mangle Files While Sticking to the PE Format</a>
                </div>
            </div>
            
            
        </li>
        
        <li>
            <div class="post-header">
                <div class="post-meta">
                    <time class="published" datetime="??">February 19, 2019</time>
                </div>
                <div class="post-title">
                    <a href="http://localhost:4000/Cryptomining_malware_1_31adf">Cryptomining Malware Sample Analysis 1: 31ADF</a>
                </div>
            </div>
            
            
        </li>
        
        <li>
            <div class="post-header">
                <div class="post-meta">
                    <time class="published" datetime="??">December 13, 2018</time>
                </div>
                <div class="post-title">
                    <a href="http://localhost:4000/binary_instrumentation">Notes on Binary Instrumentation and Intel PIN</a>
                </div>
            </div>
            
            
        </li>
        
    </ul>
</section>

<!-- Create a sorted array of tags -->
 
<section class="widget widget-tagcloud">
    <h2 class="widget-title">Tags</h2>
    <div class="tagcloud">
        
        <a href='https://nexusmaximus.github.iotag/development/'>Development</a>
        
        <a href='https://nexusmaximus.github.iotag/javascript/'>JavaScript</a>
        
        <a href='https://nexusmaximus.github.iotag/jekyll/'>Jekyll</a>
        
        <a href='https://nexusmaximus.github.iotag/node/'>Node</a>
        
        <a href='https://nexusmaximus.github.iotag/startup/'>Startup</a>
        
        <a href='https://nexusmaximus.github.iotag/startups/'>Startups</a>
        
        <a href='https://nexusmaximus.github.iotag/tips/'>Tips</a>
        
    </div>
</section>


		</div><!-- .sidebar-inside -->
	</div><!-- .sidebar-scrollable -->
</aside><!-- .sidebar -->
    
    <!-- Javascript Assets -->
    <script src="/assets/js/jquery-3.3.1.min.js"></script>
    <script src="/assets/js/plugins.js"></script>
    <script src="/assets/js/custom.js"></script>

</body>

</html>